local Base = require "core.Object"
local NetManager = class(Base)

function NetManager:InitData()
    NetManager.NetEvent = {}
    CSGlobal.RegProtoLua(NetManager.RecServer)
end

function NetManager.RegProto(protoObj, cb)
    if protoObj == nil then
        return
    end
    local data = NetManager.NetEvent[protoObj.ProtoCode]
    if (data == nil or data == -1) then
        NetManager.NetEvent[protoObj.ProtoCode] = {protoObj = protoObj, cb = cb}
    end
end

-- 收到服务器数据
function NetManager.RecServer(ProtoCode, buffer)
    local data = NetManager.NetEvent[ProtoCode]
    if (data == nil or data == -1) then
        return
    end

    data.cb(data.protoObj.GetProto(buffer))
end

return NetManager
