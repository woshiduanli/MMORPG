local require = require
local Base = require "core.Object"
local GameStateManager = class(Base)
local table = table
local coroutine = coroutine
-- local ObjectManager = require("Manager.ObjectManager")

-- 所有状态名字
GameStateManager.State = {
    None = "None",
    Init = "Init",
    -- 登录状态
    Login = "Login",
    -- 选角色
    SelectRole = "SelectRole",
    -- 游戏中
    Game = "Game"
}

-- 从游戏状态开启进入游戏
function GameStateManager:InitData()
    self.CurStateName = self.State.None
    -- self:ChangeState(self.State.Init)
    -- 进入游戏初始化
    local co = coroutine.create(self.crateInit)
    local result = coroutine.resume(co, self)
    if (result) then
        self:ChangeState(self.State.Login)
    end
end

function GameStateManager:crateInit()
    self:ChangeState(self.State.Init)
    return true 
end

--
function GameStateManager:ChangeState(StateName)
    if (StateName == self.CurStateName) then
        return false
    end

    if self.CurStateObj ~= nil then
        self.objMgr.DestroySingleObj("GameState_" .. self.CurStateName)
    end
    self.CurStateObj = self.objMgr.CreateSingleObj("GameState.GameState_" .. StateName, "GameState_" .. StateName, self)
    self.CurStateName = StateName
end

function GameStateManager.RegEvents()
end

return GameStateManager
